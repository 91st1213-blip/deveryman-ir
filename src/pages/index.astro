---
import { getLatestEarnings } from '../lib/sheets';
import { COMPANIES } from '../lib/constants';

// Google Sheetsã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
const earningsData = await getLatestEarnings();

// ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«
const title = 'ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼æ±ºç®—ã¾ã¨ã‚';
---

<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
</head>
<body style="font-family: sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px;">
  <h1>{title}</h1>
  
  <h2>ğŸ“Š ä¼æ¥­ãƒªã‚¹ãƒˆï¼ˆ{COMPANIES.length}ç¤¾ï¼‰</h2>
  <ul>
    {COMPANIES.map(company => (
      <li style={`color: ${company.color}`}>
        {company.name} - æ±ºç®—æœˆ: {company.fiscalMonth}æœˆ
      </li>
    ))}
  </ul>

  <h2>ğŸ“ˆ æœ€æ–°æ±ºç®—ãƒ‡ãƒ¼ã‚¿</h2>
  {earningsData.length > 0 ? (
    <table border="1" style="border-collapse: collapse; width: 100%;">
      <thead>
        <tr style="background: #f0f0f0;">
          <th style="padding: 10px;">ä¼æ¥­å</th>
          <th style="padding: 10px;">æ±ºç®—æœŸ</th>
          <th style="padding: 10px;">å–¶æ¥­åç›Š</th>
          <th style="padding: 10px;">å–¶æ¥­åˆ©ç›Š</th>
          <th style="padding: 10px;">çµŒå¸¸åˆ©ç›Š</th>
          <th style="padding: 10px;">ç´”åˆ©ç›Š</th>
        </tr>
      </thead>
      <tbody>
        {earningsData.map(data => (
          <tr>
            <td style="padding: 10px;">{data.companyName}</td>
            <td style="padding: 10px;">{data.fiscalPeriod}</td>
            <td style="padding: 10px; text-align: right;">{data.revenue.toLocaleString()}å„„å††</td>
            <td style="padding: 10px; text-align: right;">{data.operatingProfit.toLocaleString()}å„„å††</td>
            <td style="padding: 10px; text-align: right;">{data.ordinaryProfit.toLocaleString()}å„„å††</td>
            <td style="padding: 10px; text-align: right;">{data.netProfit.toLocaleString()}å„„å††</td>
          </tr>
        ))}
      </tbody>
    </table>
  ) : (
    <p style="color: red;">ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>
  )}
</body>
</html>
